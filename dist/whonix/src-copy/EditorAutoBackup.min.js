(function(){$("#editform").length&&setTimeout(function(){let t=!1;var n;$("#editform .ace_editor").length&&($("#editform .ace_editor").attr("id","editform-ace-editor"),n=ace.edit("editform-ace-editor")),$("#wikiEditor-ui-toolbar").append($('<i class="editor-auto-backup far fa-save"></i>'));let e=$('<div class="mini-modal" id="editorAutoBackupModal"> <div class="info">Your latest AutoBackup</div> <div class="title"></div> <div class="date"></div><textarea></textarea></div>');$("body").append(e);function s(e){let t=n&&!e?ace.edit("ace_editor").getValue():$("#wpTextbox1").val();localStorage.setItem("wikiEditorAutoBackup",JSON.stringify({content:t,date:(new Date).toLocaleString(),title:$("#firstHeading").text()}))}$(".save-and-continue").on("click",s),$("#editform").on("submit",function(e){if(t)return!0;e.preventDefault();let n=document.activeElement;return s(!0),setTimeout(function(){t=!0,$("#editform")[0].requestSubmit(n)},100),!1}),$("#wikiEditor-ui-toolbar .editor-auto-backup").on("click",function(){let t=JSON.parse(localStorage.getItem("wikiEditorAutoBackup"));e.find(".title").text(t.title),e.find(".date").text(t.date),e.find("textarea").val(t.content),$("#editorAutoBackupModal").miniModal("show")})},500)})()